---
date: 2025-03-26 11:47:47
title: Excel导入导出
permalink: /pages/097939
tags: [Spring Boot]
author:
  name: 华总
  link: https://xiaoying.org.cn
categories:
  - 后端
---



::: warning 

目前仅**Spring Boot2**可用

:::

## 引用

```java
@RestController
@RequestMapping("/excel")
public class ExcelController {
    ...
    @Resource
    private ExcelService excelService;
   ...
}
```

## Excel导入

```java
@PostMapping("/upload")
@Operation(summary = "excel导入")
@ResponseBody
public List<Excel> upload(@RequestExcel List<Excel> dataList) {

    // 数据校验
    if (dataList == null || dataList.isEmpty()) {
        throw new BusinessException(ErrorCode.PARAMS_ERROR, "上传数据为空");
    }

    // 批量保存到数据库
    boolean result = excelService.saveBatch(dataList);
    if (!result) {
        throw new BusinessException(ErrorCode.OPERATION_ERROR);
    }

    return dataList;
}
```

## Excel导出

```java
@ResponseExcel(name = "template")
@PostMapping("/export")
@Operation(summary = "excel导出")
public List<ExcelVO> exportExcelVOByPage(@RequestBody ExcelQueryRequest excelQueryRequest,HttpServletRequest request) {

    long current = excelQueryRequest.getCurrent();
    // 查询数据库
    Page<Excel> excelPage = excelService.page(new Page<>(current, 100000000),
            excelService.getQueryWrapper(excelQueryRequest));
    // 获取封装类
    Page<ExcelVO> excelVOPage = excelService.getExcelVOPage(excelPage, request);
    return excelVOPage.getRecords();
}

```

